<!DOCTYPE html>

<!--

 ██▓     ██████ ▓█████ ▓█████     █    ██
▓██▒   ▒██    ▒ ▓█   ▀ ▓█   ▀     ██  ▓██▒
▒██▒   ░ ▓██▄   ▒███   ▒███      ▓██  ▒██░
░██░     ▒   ██▒▒▓█  ▄ ▒▓█  ▄    ▓▓█  ░██░
░██░   ▒██████▒▒░▒████▒░▒████▒   ▒▒█████▓
░▓     ▒ ▒▓▒ ▒ ░░░ ▒░ ░░░ ▒░ ░   ░▒▓▒ ▒ ▒
 ▒ ░   ░ ░▒  ░ ░ ░ ░  ░ ░ ░  ░   ░░▒░ ░ ░
 ▒ ░   ░  ░  ░     ░      ░       ░░░ ░ ░
 ░           ░     ░  ░   ░  ░      ░

-->

<html>
  <head>
    <meta charset="UTF-8">
    <title>DS9 BINGO</title>
    <link href="https://fonts.googleapis.com/css2?family=Oswald&display=swap" rel="stylesheet">
    <style>
      html,body {
        width:100%;
        height:100%;
        text-align:center;
        background:#111;
        padding:0;
        margin:0;
        font-family:'Oswald', sans-serif;
      }
      p, label { color:#888; }
      table {
        font-size:26px;
        letter-spacing:0.6px;
        box-sizing:border-box;
        width:70%;
        height:90%;
        margin:25px auto;
        border:1px #333 solid;
        background:#fff;
      }
      td {
        font-weight:900;
        border-collapse:collapse;
        width:20%;
        height:20%;
        text-align:center;
        border:1px #333 solid;
        vertical-align:middle;
        background-size:cover;
        background-repeat:no-repeat;
        cursor:pointer;
        background-position:center;
        color:#333;
        transition:all 0.2s ease-in;
        position:relative;
      }

      td.active {
        color:#fff;
        text-shadow:0px 0px 8px #000;
      }

      @media screen and (max-width : 1000px){
        table {
            width:100%;
            height:100%;
        }
      }

      @media screen and (max-width : 320px){
        html,body { overflow:hidden; }
        table {
            width:320px;
            font-size:0.8em;
            margin:0;
            height:50%;
            border:none;
            table-layout:fixed;
        }
        td {
            border:1px #333 solid;
            word-wrap: break-word;
        }

      }
    </style>
  </head>
  <body>

    <form><label><input type="checkbox" id="toggle-safemode">Season 1-2 safemode</label></form>

    <table>
    <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td id="free">Free</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
</table>
<p>Refresh to get a new board!</p>

<script>

    var api_key = "FR57D8JH3LYH";
    var search_terms = ["Star Trek DS9", "Deep Space Nine Star Trek", "Sisko DS9", "Quark DS9", "Odo DS9", "Dax DS9", "Kira DS9", "Gul Dukat DS9", "Garak DS9", "Obrien DS9"];

    var season_1_thru_2 = [
    'Spatial anomaly',
    'Seemingly friendly alien with ominous motives',
    'Someone gets kidnapped',
    'Temporal anomaly!',
    'Distress call received',
    '"Polarity"',
    'Banger hits the ship/station',
    'Episode gets sexy',
    '"SensOARS"',
    '"Diagnostics"',
    '"Modulate"',
    'Computer is unable to comply',
    'Tractor beam!',
    '"Plot a course..."',
    '"Personal Log"',
    'A system is down',
    'Someone is stunned with a phaser',
    'Someone is flung from their console',
    'Someone dies',
    'Someone\'s phrasing can easily be turned sexual',
    'Yet another warrior race shows up',
    'Actor from another Trek series shows up (besides main cast)',
    "Baseball is mentioned/seen",
    "Sisko scolds somebody",
    "Sisko calls Dax old man",
    "Sisko hugs/kisses Jake",
    "Sisko's wife is mentioned",
    "Sisko raises his voice",
    "Quark is up to something possibly illegal",
    "Quark begs/pleads",
    "Latinum is mentioned",
    "Someone gets Oomox",
    "Someone is grabbed by the ear",
    "Grand Nagus shows up",
    "Rom says 'moogie'",
    "Rom is secretly being smart",
    "Kira reminds us of her past",
    "Kira acts impulsively",
    "Kira is religious",
    "Kira starts to get romantic with someone",
    "Odo pines for Kira",
    "Odo catches/foils Quark",
    "Odo alludes to his past",
    "Odo transforms",
    "Odo knows more than he lets on",
    "Odo makes a grumbling sound/harrumph",
    "Jake and Nog hanging out",
    "Jake/Nog get in trouble",
    "Jake is writing something",
    "Nog complains",
    "Dax alludes to past lives",
    "Dax says \"Benjamin\"",
    "Bashir hits on someone",
    "Bashir saves a life",
    "Bashir and Garak hanging out",
    "Rom knows more than he lets on",
    "O'Brien complains",
    "O'Brien hanging out with Bashir",
    "O'Brien performs an engineering miracle",
    "O'Brien must suffer",
    "Keiko complains",
    "Excuse for Keiko not being around",
    "Keiko shows up",
    "Molly shows up",
    "Raktajino is drunk",
    "Kanar is drunk",
    "Someone yells \"DABO!\"",
    "Darts are played",
    "Runabout/Defiant is flown",
    "Runabout is destroyed",
    "Wormhole opens (besides intro)",
    "Kira takes no shit",
    "Quark pours a drink",
    "Prophets speak to someone",
    "Prophet's orb get used",
    "Klingons show up (not Worf)",
    "Cardassians show up",    
    "Bajorans show up (not Kira)",
    "Breen show up",
    "Romulans show up",
    "One of them Sisko boys goes on a date",
    "A rule of acquisition is named",
    "Morn is at the bar",
    "First contact with a race from Gamma Quadrant",
    "A ship docks with DS9",
    "Garak alludes to secrets",
    "Garak is \"just a tailor\"",
    "Garak joins the gang",
    "Garak does tailoring/we see his shop",
    "Gul Dukat is friendly but obviously up to something",
    "Gul Dukat loses his cool",
    "Gul Dukat justifies atrocities",
    "Kai Winn does something secretly evil",
    "Kai Winn patronizes someone",
    "Vic Fontaine shows up",
    "Leeta's cleavage",
    "Knuck",
    "We're on Bajor",
    "We're in the Gamma quadrant",
    "We're in the mirror universe",
    "We're in sicks bay",
    "We're in the past/future",
    "We're on Earth",
    "We're in someone's quarters",
    "Hail acknowledged",
    "Hail ignored",
    "Transporter is used",
    "Replicator is used",
    "Turbolift scene",
    "Holosuites are used",
    "Someone dresses up for holosuites",
    "Stardate is mentioned",
    "Earth is mentioned",
    "Bajor is mentioned",
    "Cardassian planet/moon is mentioned",
    "Reference to another series",
    "DS9 is under attack/captured",
    "A phaser is fired",
    "Alien says \"human\" like it's an insult",
    "Orders are disobeyed",
    "Comm badges don't work",
    "Shields are down",
    "A PADD is handed to someone",
    "A system is offline",
    "There's a containment field",
    "Someone removes an article of clothing/uniform",
    "Scene focused on people having a meal",
    "Station malfunction",
    "Someone is wearing a frontzip uniform",
    "The Maquis are mentioned/show up",    
    "MacLaughlin group: ISSUE ONE!",
    "All senior staff are called",
    "\"Some kind of...\"",
    "Sisko smiles",
    "Jem'hadar show up",
    "Founders show up (not Odo)",
    "\"On screen.\"",
    "Someone calls Odo \"constable\""
];

var season_3_and_up = [
"Ketracel white is taken",
"Jeffery Combs shows up",
"Weyoun dies/new Weyoun shows up",
"A belt buckle is seen",
"Worf gets mad",
"Worf is acting prudish",
];

var default_stuff = season_1_thru_2.concat(season_3_and_up);

function load_cells(stuff){
  var chosen_list = stuff.slice() // clone it
  console.log(chosen_list.length)
  var cells = document.querySelectorAll('td:not(#free)');
  cells.forEach(function(cell){
      pick = Math.floor(Math.random()*chosen_list.length);
      cell.innerHTML = chosen_list[pick];
      chosen_list.splice(pick, 1);
  })
}

    document.addEventListener("DOMContentLoaded", function(){     
        
        load_cells(default_stuff);

        var toggle = document.getElementById("toggle-safemode");
        toggle.addEventListener("change", function(e){
          var stuff;
          if(e.currentTarget.checked){
            stuff = season_1_thru_2;
          } else {
            stuff = default_stuff;
          }
          
          load_cells(stuff)
        });

        var allcells = document.querySelectorAll('td')
        allcells.forEach(function(cell){
            cell.addEventListener('click', function(){

                var toggle = this.style;
                var search_url = "https://api.tenor.com/v1/random?q=" + search_terms[Math.floor(Math.random()*search_terms.length)] + "&key=" + api_key + "&limit=5&contentfilter=low";
                
                cell.className = cell.className ? "" : "active";
                
                if(cell.className == "active"){
                    fetch(search_url)
                    .then(data => data.json())
                    .then(data => {
                        toggle.backgroundImage = "url("+data.results[0].media[0].tinygif.url+")";
                    })
                } else {
                    toggle.backgroundImage = "";
                }
            });
        })
    });



  </script>
  </body>
</html>